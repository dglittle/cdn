
<body style="margin:0px">
<script>

throw 'stop'

var tau = Math.PI * 2

var c = document.createElement('canvas')
c.width = 200
c.height = 400
document.body.append(c)
var g = c.getContext('2d')

var cc = document.createElement('canvas')
cc.width = 200
cc.height = 400
document.body.append(cc)
var gg = cc.getContext('2d')

var xn = 2

var q_spins = []
var q_prevs = []

var qq_spins = []
var qq_prevs = []

var spins = []
var vels = []
for (var x = 0; x < xn; x++) {
    var val = 3 * x
    
    q_spins.push(val)
    q_prevs.push(val)
    
    qq_spins.push(val)
    qq_prevs.push(val)
    
    spins.push(val)
    vels.push(0)
}

function update_it() {
    
    //debugger
    
    var x0 = spins[0]
    var x1 = spins[1]
    var mag = Math.abs(x0 - x1)/1000
    if (x0 > x1) {
        vels[0] -= mag
        vels[1] += mag
    } else {
        vels[0] += mag
        vels[1] -= mag
    }
    
    spins[0] += vels[0]
    spins[1] += vels[1]
    


    
    var a = q_spins[0]
    var b = q_spins[1]
    var mag = Math.abs(a - b)/1000
    if (a > b) {
        q_spins[0] -= mag
        q_spins[1] += mag
    } else {
        q_spins[0] += mag
        q_spins[1] -= mag
    }
    
    for (var x = 0; x < xn; x++) {
        var prev = q_prevs[x]
        q_prevs[x] = q_spins[x]
        q_spins[x] = lerp(0, prev, 1, q_spins[x], 2)
    }




    
    for (var x = 0; x < xn; x++) {
        var prev = qq_prevs[x]
        qq_prevs[x] = qq_spins[x]
        qq_spins[x] = lerp(0, prev, 1, qq_spins[x], 2)
    }

    var a = qq_spins[0]
    var b = qq_spins[1]
    var mag = Math.abs(a - b)/2000
    if (a > b) {
        qq_spins[0] -= mag
        qq_spins[1] += mag
    } else {
        qq_spins[0] += mag
        qq_spins[1] -= mag
    }
    
}

function paint_it() {
    var x = t / 10
    
    g.fillStyle = 'rgba(255, 255, 255, 0.01)'
    g.fillRect(0, 0, c.width, c.height)
    
    g.fillStyle = 'red'
    g.beginPath()
    g.arc(x, lerp(0, c.height, 3, 0, spins[0]), 3, 0, tau)
    g.fill()

    g.fillStyle = 'orange'
    g.beginPath()
    g.arc(x, lerp(0, c.height, 3, 0, spins[1]), 3, 0, tau)
    g.fill()
    
    
    gg.fillStyle = 'rgba(255, 255, 255, 0.01)'
    gg.fillRect(0, 0, cc.width, cc.height)
    
    gg.fillStyle = 'red'
    gg.beginPath()
    gg.arc(x, lerp(0, c.height, 3, 0, q_spins[0]), 3, 0, tau)
    gg.fill()

    gg.fillStyle = 'orange'
    gg.beginPath()
    gg.arc(x, lerp(0, c.height, 3, 0, q_spins[1]), 3, 0, tau)
    gg.fill()
    
    
    
    
    gg.fillStyle = 'cyan'
    gg.beginPath()
    gg.arc(x, lerp(0, c.height, 3, 0, qq_spins[0]), 3, 0, tau)
    gg.fill()

    gg.fillStyle = 'green'
    gg.beginPath()
    gg.arc(x, lerp(0, c.height, 3, 0, qq_spins[1]), 3, 0, tau)
    gg.fill()
    
}

var t = 0

function loop() {
    update_it()
    paint_it()

    t++    
    setTimeout(loop, 100)
}
loop()

function lerp(t0, v0, t1, v1, t) {
    if (t0 == t1) return v0
    return (t - t0) * (v1 - v0) / (t1 - t0) + v0
}

</script>
</body>
